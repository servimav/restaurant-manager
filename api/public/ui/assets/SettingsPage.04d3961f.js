import{d as q,o as f,e as Q,w as r,f as e,as as _,J as C,K as w,at as S,U as D,r as V,c as k,ah as L,b3 as R,u as v,aI as x,aA as N,Q as F,L as T,aC as B,aq as h,ai as b,au as I,al as E,am as K,aK as M,aM as O,av as j,aL as z}from"./index.04fb470e.js";import{Q as G}from"./QPagination.36b8f6b7.js";import{Q as H}from"./QPage.35b7a6ff.js";import{Q as J}from"./QSelect.d11fb4e1.js";import{Q as W}from"./QForm.88d99e78.js";import{i as A}from"./index.6925d095.js";import{u as $}from"./notification.bcef4808.js";import{_ as X}from"./plugin-vue_export-helper.21dcd24c.js";import"./format.3e32b8d9.js";import"./QChip.2f03b717.js";import"./selection.07c9d277.js";import"./rtl.b51694b1.js";import"./router.1722d853.js";const Y={class:"text-h6"},Z={class:"text-subtitle2"},ee=q({__name:"UserWidget",props:{data:null},setup(m){return(p,s)=>(f(),Q(S,null,{default:r(()=>[e(_,null,{default:r(()=>{var n;return[C("div",Y,w(m.data.name)+" ("+w((n=m.data.role)==null?void 0:n.toLocaleUpperCase())+") ",1),C("div",Z,w(m.data.phone),1)]}),_:1})]),_:1}))}});const ae={class:"text-h6 text-center"},te=q({__name:"UserForm",props:{update:null},emits:["completed","destroy"],setup(m,{emit:p}){const s=m,n=["manager","camarero"],g=A(D),a=V({name:"",password:"",password_confirmation:"",phone:"",role:"camarero"}),c=k(()=>Boolean(s.update));async function y(){if(a.value.password!==a.value.password_confirmation)B.create({message:"Las contrase\xF1as no coinciden",color:"negative"});else try{let d;c.value&&s.update?d=(await g.update(s.update.id,a.value)).data:d=(await g.store(a.value)).data,p("completed",d)}catch(d){$.axiosError(d)}}return L(()=>{s.update&&(a.value={name:s.update.name,password:"",password_confirmation:"",phone:s.update.phone,role:"camarero"})}),(d,t)=>(f(),Q(S,null,{default:r(()=>[e(W,{onSubmit:R(y,["prevent"])},{default:r(()=>[e(_,null,{default:r(()=>[C("div",ae,w(v(c)?"Actualizar":"Crear")+" Usuario ",1)]),_:1}),e(_,{class:"q-gutter-y-sm"},{default:r(()=>[e(x,{modelValue:a.value.name,"onUpdate:modelValue":t[0]||(t[0]=l=>a.value.name=l),type:"text",label:"Nombre",required:""},null,8,["modelValue"]),e(x,{modelValue:a.value.phone,"onUpdate:modelValue":t[1]||(t[1]=l=>a.value.phone=l),type:"tel",label:"Telefono",readonly:v(c),required:""},null,8,["modelValue","readonly"]),e(J,{modelValue:a.value.role,"onUpdate:modelValue":t[2]||(t[2]=l=>a.value.role=l),style:{"text-transform":"uppercase"},options:n,label:"Rol"},null,8,["modelValue"]),e(x,{modelValue:a.value.password,"onUpdate:modelValue":t[3]||(t[3]=l=>a.value.password=l),type:"password",label:"Contrase\xF1a",required:""},null,8,["modelValue"]),e(x,{modelValue:a.value.password_confirmation,"onUpdate:modelValue":t[4]||(t[4]=l=>a.value.password_confirmation=l),type:"password",label:"Repita Contrase\xF1a",required:""},null,8,["modelValue"])]),_:1}),e(N,null,{default:r(()=>[e(F,{color:"primary",icon:"mdi-check",label:"Guardar",type:"submit"}),v(c)?(f(),Q(F,{key:0,color:"negative",icon:"mdi-delete",label:"Eliminar",onClick:t[5]||(t[5]=l=>p("destroy",m.update))})):T("",!0)]),_:1})]),_:1},8,["onSubmit"])]),_:1}))}});var oe=X(te,[["__scopeId","data-v-0cc8e39e"]]);const le={class:"row q-col-gutter-sm"},xe=q({__name:"SettingsPage",setup(m){const p=A(D),s=V(!1),n=V({data:[],links:{},meta:{current_page:0}}),g=k(()=>n.value.meta.last_page?Number(n.value.meta.last_page):n.value.meta.current_page),a=V(),c=k(()=>n.value.data);function y(u){a.value=u||void 0,s.value=!0}async function d(u){await U(u),M()}async function t(u){if(u.id===1){B.create({message:`No se puede eliminar el usuario ${u.name} porque es un usuario protegido`,color:"negative"});return}O.create({title:"Eliminar Usuario",message:`Desea eliminar el usuario ${u.name}`,ok:"Eliminar",cancel:"Cancelar"}).onOk(async()=>{try{await p.destroy(u.id),l()}catch(o){$.axiosError(o)}})}function l(){s.value=!1,a.value=void 0,U()}async function U(u=1){try{n.value=(await p.list(u)).data}catch(o){$.axiosError(o)}}return L(async()=>{h("Ajustes"),await U()}),(u,o)=>(f(),b(E,null,[e(H,{padding:""},{default:r(()=>[e(S,{class:"no-box-shadow"},{default:r(()=>[e(_,null,{default:r(()=>[e(F,{icon:"mdi-plus",label:"A\xF1adir Usuario",class:"full-width",color:"primary",onClick:o[0]||(o[0]=i=>y(void 0))})]),_:1})]),_:1}),e(_,{class:"q-px-none"},{default:r(()=>[C("div",le,[(f(!0),b(E,null,K(v(c),(i,P)=>(f(),b("div",{class:j(v(z)),key:`user-${i.id}-${P}`},[e(ee,{data:i,onClick:re=>y(i)},null,8,["data","onClick"])],2))),128))])]),_:1}),e(N,{class:"q-pa-lg flex flex-center"},{default:r(()=>[e(G,{modelValue:n.value.meta.current_page,"onUpdate:modelValue":[o[1]||(o[1]=i=>n.value.meta.current_page=i),o[2]||(o[2]=i=>d(i))],max:v(g),input:""},null,8,["modelValue","max"])]),_:1})]),_:1}),e(I,{modelValue:s.value,"onUpdate:modelValue":o[4]||(o[4]=i=>s.value=i)},{default:r(()=>[e(oe,{class:"dialog-form",update:a.value,onCompleted:l,onDestroy:o[3]||(o[3]=i=>t(i))},null,8,["update"])]),_:1},8,["modelValue"])],64))}});export{xe as default};
